<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticker Analysis - Daily Market Summary</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-[#0a0f19] via-[#1a1f2e] to-[#0a0f19] min-h-screen text-white">
    <div class="container mx-auto px-6 py-8 max-w-5xl">
        <!-- Header -->
        <header class="mb-8">
            <a href="/" class="text-blue-400 hover:text-blue-300 mb-4 inline-block">‚Üê Back to Daily Summary</a>
            <h1 class="text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent mb-2" id="tickerTitle">
                Loading...
            </h1>
            <div class="flex items-center gap-4 text-gray-400" id="tickerStats"></div>
        </header>

        <!-- Loading State -->
        <div id="loading" class="text-center py-20">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"></div>
            <p class="text-gray-400 mt-4">Analyzing ticker...</p>
        </div>

        <!-- Content -->
        <div id="content" class="hidden space-y-6">
            <!-- Trend Analysis -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üìä Trend Analysis</h2>
                <div id="trendAnalysis" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
            </section>

            <!-- Fibonacci Levels -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üéØ Fibonacci Retracement Levels</h2>
                <div class="text-sm text-gray-400 mb-4">Based on recent swing: ${tickerData.fibonacci?.swing_low} - ${tickerData.fibonacci?.swing_high}</div>
                <div id="fibonacciLevels" class="space-y-2"></div>
            </section>

            <!-- Price Action -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üìä Price Action Summary</h2>
                <p class="text-gray-300 leading-relaxed" id="priceAction"></p>
            </section>

            <!-- Technical Analysis -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üìà Technical Analysis</h2>
                <ul class="space-y-3 text-gray-300" id="technicalAnalysis"></ul>
            </section>

            <!-- Key Levels -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üéØ Key Levels to Watch</h2>
                <div class="space-y-3" id="keyLevels"></div>
            </section>

            <!-- Trading Considerations -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">üí° Trading Considerations</h2>
                <ul class="space-y-3 text-gray-300" id="tradingConsiderations"></ul>
            </section>

            <!-- Risk Assessment -->
            <section class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6">
                <h2 class="text-2xl font-semibold mb-4 border-b border-purple-500 pb-2">‚ö†Ô∏è Risk Assessment</h2>
                <ul class="space-y-3 text-gray-300" id="riskAssessment"></ul>
            </section>

            <!-- Disclaimer -->
            <div class="bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-6">
                <p class="text-sm text-yellow-200 text-center">
                    <strong>EDUCATIONAL CONTENT ONLY:</strong> This analysis is for educational purposes only and does not constitute 
                    financial advice, investment recommendations, or an offer to buy or sell securities. Always conduct your own 
                    research and consult with a licensed financial advisor before making investment decisions.
                </p>
            </div>
        </div>

        <!-- Error State -->
        <div id="error" class="hidden text-center py-20">
            <p class="text-red-400 text-xl">Unable to load analysis</p>
            <p class="text-gray-400 mt-2">Please try again</p>
            <a href="/" class="mt-4 inline-block text-blue-400 hover:text-blue-300">‚Üê Back to Home</a>
        </div>
    </div>

    <script>
        function displayAnalysis() {
            const data = JSON.parse(sessionStorage.getItem('tickerAnalysis'));
            
            if (!data) {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('error').classList.remove('hidden');
                return;
            }

            const { ticker, data: tickerData, analysis } = data;

            // Title and stats
            const changeColor = tickerData.change >= 0 ? 'text-green-400' : 'text-red-400';
            document.getElementById('tickerTitle').textContent = `${ticker} Analysis`;
            document.getElementById('tickerStats').innerHTML = `
                <span class="text-3xl font-bold">$${tickerData.price}</span>
                <span class="${changeColor} font-semibold">${tickerData.change >= 0 ? '+' : ''}${tickerData.change} (${tickerData.change_percent}%)</span>
                <span class="text-gray-500">|</span>
                <span>Vol: ${tickerData.volume.toLocaleString()}</span>
                <span class="text-gray-500">|</span>
                <span>52W: $${tickerData.low_52w} - $${tickerData.high_52w}</span>
            `;

            // Trend Analysis
            if (tickerData.trend) {
                const trendDiv = document.getElementById('trendAnalysis');
                const trendColor = tickerData.trend.direction.includes('Up') ? 'text-green-400' : 
                                   tickerData.trend.direction.includes('Down') ? 'text-red-400' : 'text-yellow-400';
                trendDiv.innerHTML = `
                    <div class="bg-[#252a3a] rounded-lg p-4 text-center">
                        <div class="text-gray-400 text-xs mb-1">Direction</div>
                        <div class="${trendColor} text-lg font-bold">${tickerData.trend.direction}</div>
                    </div>
                    <div class="bg-[#252a3a] rounded-lg p-4 text-center">
                        <div class="text-gray-400 text-xs mb-1">Strength</div>
                        <div class="text-white text-lg font-bold">${tickerData.trend.strength}</div>
                    </div>
                    <div class="bg-[#252a3a] rounded-lg p-4 text-center">
                        <div class="text-gray-400 text-xs mb-1">Momentum</div>
                        <div class="text-white text-lg font-bold">${tickerData.trend.momentum}</div>
                    </div>
                    <div class="bg-[#252a3a] rounded-lg p-4 col-span-2 md:col-span-1">
                        <div class="text-gray-400 text-xs mb-1">Analysis</div>
                        <div class="text-gray-300 text-sm">${tickerData.trend.description}</div>
                    </div>
                `;
            }

            // Fibonacci Levels
            if (tickerData.fibonacci) {
                const fibDiv = document.getElementById('fibonacciLevels');
                const fib = tickerData.fibonacci;
                const currentPrice = tickerData.price;
                
                const levels = [
                    { name: '0.0% (High)', value: fib.level_0, pct: '0.0%' },
                    { name: '23.6%', value: fib.level_236, pct: '23.6%' },
                    { name: '38.2%', value: fib.level_382, pct: '38.2%' },
                    { name: '50.0%', value: fib.level_500, pct: '50.0%' },
                    { name: '61.8%', value: fib.level_618, pct: '61.8%' },
                    { name: '78.6%', value: fib.level_786, pct: '78.6%' },
                    { name: '100% (Low)', value: fib.level_100, pct: '100%' }
                ];
                
                levels.forEach(level => {
                    const isNear = Math.abs(currentPrice - level.value) / currentPrice < 0.02; // Within 2%
                    const div = document.createElement('div');
                    div.className = `flex justify-between items-center p-3 rounded ${isNear ? 'bg-purple-900/30 border border-purple-500' : 'bg-[#252a3a]'}`;
                    div.innerHTML = `
                        <span class="text-gray-300">${level.name}</span>
                        <span class="font-mono font-bold ${isNear ? 'text-purple-400' : 'text-white'}">$${level.value}</span>
                        ${isNear ? '<span class="text-xs text-purple-400">‚Üê Current</span>' : ''}
                    `;
                    fibDiv.appendChild(div);
                });
            }

            // Price Action
            document.getElementById('priceAction').textContent = analysis.price_action;

            // Technical Analysis
            const techList = document.getElementById('technicalAnalysis');
            analysis.technical_analysis.forEach(item => {
                const li = document.createElement('li');
                li.className = 'flex items-start';
                li.innerHTML = `<span class="text-purple-400 mr-2">‚Ä¢</span><span>${item}</span>`;
                techList.appendChild(li);
            });

            // Key Levels
            const levelsDiv = document.getElementById('keyLevels');
            analysis.key_levels.forEach(level => {
                const div = document.createElement('div');
                div.className = 'bg-[#252a3a] rounded-lg p-4';
                div.innerHTML = `
                    <div class="font-semibold text-purple-400 text-lg mb-2">$${level.level}</div>
                    <div class="text-gray-300 text-sm">${level.note}</div>
                `;
                levelsDiv.appendChild(div);
            });

            // Trading Considerations
            const tradingList = document.getElementById('tradingConsiderations');
            analysis.trading_considerations.forEach(item => {
                const li = document.createElement('li');
                li.className = 'flex items-start';
                li.innerHTML = `<span class="text-blue-400 mr-2">‚Ä¢</span><span>${item}</span>`;
                tradingList.appendChild(li);
            });

            // Risk Assessment
            const riskList = document.getElementById('riskAssessment');
            analysis.risk_assessment.forEach(item => {
                const li = document.createElement('li');
                li.className = 'flex items-start';
                li.innerHTML = `<span class="text-yellow-400 mr-2">‚ö†</span><span>${item}</span>`;
                riskList.appendChild(li);
            });

            // Show content
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('content').classList.remove('hidden');
        }

        // Load on page load
        displayAnalysis();
    </script>
</body>
</html>
